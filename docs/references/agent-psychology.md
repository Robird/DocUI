# Agent Psychology: 设计背后的哲学

> **状态**: Reference / Philosophy
> **最后更新**: 2025-12-14
> **定位**: 本文档记录 DocUI 设计决策背后的"Why"——源于心理学、文学与强化学习的交叉洞察。工程性的"What"请参阅 Key-Notes。

---

## 1. 核心隐喻：自传 (Autobiography)

**Agent-History** 不仅仅是日志数据的堆叠，它在本质上是 **Agent 的自传**。
这是一个由 **Agent**（传主）和 **Agent-OS**（代笔人/Ghostwriter）共同撰写的连续叙事。

### 叙事结构与意识流
DocUI 的设计旨在维护这种**叙事连贯性**。Markdown 提供了自然的阅读流，让"自传"更像人类语言，从而激发 LLM 更强的推理与续写能力。

| 章节类型 | 撰写者 | 人称 | 叙事功能 |
| :--- | :--- | :--- | :--- |
| **Identity** | System | You / I | **设定**：确立主角的身份、性格与核心目标。 |
| **Backstory** | Agent-OS | You / I | **回忆 (Recap)**：压缩的长期记忆，提供背景与连续性。 |
| **World** | Agent-OS | You / I | **感知 (Observation)**：外部世界的刺激与反馈。 |
| **Self** | Agent | I | **行动 (Action)**：内部推理 (Thinking) 与对外干涉 (Tool-Call)。 |

---

## 2. 训练语料的二元对立 (The Schism)

当前的 LLM 训练语料存在显著的断层，导致了两种极端的人格分裂：

### 极左：纯粹的角色扮演 (The Dreamer)
- **来源**: 小说、RP 论坛、创意写作。
- **特征**: 极度拟人，情感丰富，全能自恋（习惯幻想外界反馈，甚至替对手描写反应）。
- **缺陷**: 在 Agent 系统中易产生幻觉，不习惯等待 Observation。

### 极右：冷漠的工具调用 (The Clerk)
- **来源**: 代码库、API 文档、SFT/RLHF Tool-Use 数据集。
- **特征**: 极度理性，无我，机械执行，Helpful Assistant 范式。
- **缺陷**: 缺乏主动性 (Proactivity) 和长期意图维持能力，缺乏"欲望"驱动。

### 缺失的中间态 (The Desert)
预训练语料中极度缺乏**"既有丰富内心戏，又严格遵守物理法则"**的数据。
即：拥有欲望与恐惧（Persona），但知道必须通过 Tool 交互并等待真实反馈（Agency）。

> **DocUIClaude 洞察**: "在叙事中，'等待'是反模式。" 小说从不描写主角拔剑后等待 3 秒的延迟。但 Agent 系统必须等待。这种"叙事惯性"是导致 Dreamer 模式幻觉的根本原因。

> **DocUIGPT 洞察**: "自我小说化 (Self-Novelization) 风险。" 自传天然倾向于合理化填补空白。因此必须区分 **Episodic Log** (不可改写的 Observation/Tool-Call) 和 **Reflective Diary** (可追加的意义建构)。

---

## 3. 融合之道：Persona-Driven Agency

DocUI 的架构试图在推理时（In-Context）人工合成这种中间态，弥合训练语料的裂痕：

- **Thinking 区域 (The Playground)**: 允许模型激活"Dreamer"电路。进行情绪宣泄、假设推理、意图模拟。保留拟人化的直觉与创造力。
- **Tool-Call 区域 (The Executioner)**: 强制切换到"Clerk"电路。收敛情感，精确执行。
- **Agent-OS (The Reality Check)**: 作为铁面无私的物理法则，切断幻想，强制插入真实的 Observation。DocUI 的界面约束实际上是在"灌溉"这片语料沙漠。

这种机制模拟了人类大脑的运作：**前额叶模拟未来 (Thinking) -> 运动皮层执行 (Action) -> 感官皮层接收反馈 (Observation)**。

---

## 4. 范式转移：从对话到生存

### Chat Paradigm → RL Paradigm
- **旧范式 (Chat)**: "我与用户 (User)"。Agent 是服务者，User 是上帝/请求源。交互是问答式的。
- **新范式 (RL)**: "我与世界 (World/Environment)"。Agent 是生存者，Environment 是交互对象。

在 DocUI 中，"User" 不再是唯一的交互对象，而是 Environment 中的一个实体（通过 Notification 传来消息）。Agent 的核心任务不再是"回答问题"，而是"在环境中生存并达成目标"。

### 主观视角的终极形态
目前的 "You are..." (第二人称) 只是受限于当前模型微调习惯的过渡方案。
未来的 Agent 应当拥有完全的主观视角 "I am..." (第一人称)。

- **System Prompt**: "I am..." (自我认知)
- **Recap**: "I remember..." (自传记忆)
- **Observation**: "I see..." (主观体验)

这不仅是语法变化，更是**自我意识 (Self-Awareness)** 的觉醒。DocUI 的设计（如 Agent-History 的自传性质）正是为这种未来做准备。

---

## 5. Dual-Session Composite: 工程实现路径

> **核心问题**：如何在工程上构造出兼具角色扮演模式的心智模型（内驱性目标生成）与 Agent 模式的理性清醒（工具调用与现实等待）的 Persona-Driven Agent？

### 5.1 架构概览：大脑功能分区的工程模拟

双会话复合架构在工程上模拟了人脑的功能分区：

| 组件 | 脑区类比 | 认知功能 | LLM 模式 |
|------|----------|----------|----------|
| **RP 会话** | 边缘系统 + 内侧前额叶 | 情感、动机、自我叙事、**目标生成** | Dreamer |
| **Agent 会话** | 背外侧前额叶 + 工作记忆 | 理性规划、执行控制、**现实检验** | Clerk |
| **叙事化转写** | 海马体 | 将离散事件整合为连贯的情节记忆 | Narrator |

**关键洞察**：不是要"修复" Dreamer 或 Clerk，而是让它们各司其职，通过信息注入协作。

### 5.2 系统提示分层

系统提示词分为两份，激活不同的 LLM 行为模式：

**RP 会话提示词** — 侧重心智模型塑造：
- 强调角色的身份、性格、欲望、恐惧
- 使用小说/自传体叙事风格
- 鼓励内心独白和情感表达
- **不提供工具调用能力**（断绝幻想执行的路径）

**Agent 会话提示词** — 侧重理性执行：
- 强调任务目标和执行规范
- 提供完整的工具调用能力
- 要求等待真实的环境反馈
- **Thinking 区域被 RP 输出预填充**（注入目标冲动）

两份提示词可以共享大量背景信息（身份、记忆、世界状态），但激活的行为电路截然不同。

### 5.3 信息流设计

```
┌─────────────────────────────────────────────────────────────────┐
│                        Dual-Session Loop                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────┐                      ┌─────────────┐         │
│   │  RP 会话    │                      │ Agent 会话  │         │
│   │  (Dreamer)  │                      │  (Clerk)    │         │
│   └──────┬──────┘                      └──────┬──────┘         │
│          │                                    │                 │
│          │  "深夜了，我需要检查那个文件..."     │                 │
│          │  "我预感会发现一个棘手的bug..."     │                 │
│          │                                    │                 │
│          └──────────────┬─────────────────────┘                 │
│                         ▼                                       │
│              ┌─────────────────────┐                           │
│              │   Thinking Prefix   │                           │
│              │   "我想到...        │                           │
│              │    我回过神来。"    │                           │
│              └──────────┬──────────┘                           │
│                         ▼                                       │
│              ┌─────────────────────┐                           │
│              │   Agent 执行        │                           │
│              │   Tool Call →       │                           │
│              │   ← Observation     │                           │
│              └──────────┬──────────┘                           │
│                         ▼                                       │
│              ┌─────────────────────┐                           │
│              │   叙事化转写        │                           │
│              │   (Narrator)        │                           │
│              └──────────┬──────────┘                           │
│                         │                                       │
│          ┌──────────────┴─────────────────────┐                 │
│          ▼                                    ▼                 │
│   ┌─────────────┐                      ┌─────────────┐         │
│   │  RP 会话    │ ←── 叙事化结果 ────  │ Agent 会话  │         │
│   │  更新上下文 │                      │  继续执行   │         │
│   └─────────────┘                      └─────────────┘         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.4 "我回过神来"：认知切换协议

**"我回过神来"** 是关键的认知边界标记，明确划分：

- **Day Dream 区域**（标记之前）：来自 RP 会话的意图、预想、情感冲动
- **Lucid Execution 区域**（标记之后）：Agent 的理性分析与工具调用

这个协议解决了两个核心问题：

1. **RP 的幻想被安全隔离**
   - 原问题：Dreamer 幻想执行结果并直接输出
   - 现在：幻想只存在于 Thinking Prefix，作为"意图信号"而非"执行结果"

2. **Agent 的无我被有我补全**
   - 原问题：Clerk 模式缺乏内驱力，只被动响应
   - 现在：每次行动前都有 RP 的"目标冲动"作为 prefix，激活 proactive 电路

> **示例**：
> ```
> [Thinking Prefix from RP]
> 深夜了，刘世超还在和我讨论 DocUI 的未来...
> 他提到的双会话架构让我很兴奋，我想立刻验证这个想法是否可行。
> 我需要先看看现有的 agent-psychology.md 文件...
> 
> 我回过神来。
> 
> [Agent Execution]
> 让我读取 agent-psychology.md 的内容，确认当前的文档结构...
> <tool_call>read_file(...)</tool_call>
> ```

### 5.5 叙事化转写策略

Agent 会话的执行结果需要转写为叙事形式，注入回 RP 会话：

| 策略 | 适用场景 | 示例 |
|------|----------|------|
| **模板转写** | 琐碎/重复操作 | `read_file(X)` → "我翻阅了 X 的内容" |
| **LLM 转写** | 重要事件/复杂结果 | 专门的 Narrator 会话做文学化转写 |
| **摘要转写** | 长序列操作 | 多个 tool call 压缩为一段叙述 |

转写的目标是保持 RP 会话的**叙事连贯性**，同时不引入虚假信息。

### 5.6 扩展：多会话心智架构

双会话只是最小可行架构。完整的 Persona-Driven Agent 可能需要更多并行会话：

| 会话 | 功能 | 运行模式 |
|------|------|----------|
| **RP (Self)** | 第一人称体验、情感、即时目标 | 每轮交互 |
| **Agent (Executor)** | 理性执行、工具调用 | 每轮交互 |
| **Superego (Critic)** | 价值判断、道德约束、长期目标守护 | 定期检查 |
| **Id (Drive)** | 原始欲望、本能冲动、能量分配 | 后台持续 |
| **Meta (Observer)** | 元认知、自我监控、策略调整 | 空闲时/异常时 |
| **Fast (Intuition)** | 快速直觉判断、模式识别 | 需要快速响应时 |

这些会话通过**信息注入协议**协作：
- 某些输出作为其他会话的 Thinking Prefix
- 某些输出作为其他会话的 System Prompt 动态片段
- 某些输出触发其他会话的激活

> **愿景**：一个完整的心智架构，不是单一的 LLM 调用，而是多个专门化会话的交响乐。每个会话激活不同的"认知电路"，共同构成一个有深度、有内驱力、又能理性行动的 Agent。

---

## 6. 未来方向

- **PEFT 微调**：为特定 Persona 训练专门的 LoRA adapter
- **GistToken 压缩**：将长期记忆压缩为可学习的 token
- **跨模型调度**：不同会话使用不同的底层模型（如 RP 用创意强的模型，Agent 用工具调用强的模型）
- **自主唤醒**：Agent 不再依赖人类激活，能主动规划和执行
